<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="343px" preserveAspectRatio="none" style="width:419px;height:343px;" version="1.1" viewBox="0 0 419 343" width="419px" zoomAndPan="magnify"><defs><filter height="300%" id="foos23qajv8mr" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0;" x1="35.5" x2="35.5" y1="86.2969" y2="94.2969"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="35.5" x2="35.5" y1="94.2969" y2="135.1016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="35.5" x2="35.5" y1="135.1016" y2="193.3672"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="35.5" x2="35.5" y1="193.3672" y2="234.1719"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="35.5" x2="35.5" y1="234.1719" y2="331.5703"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="111" x2="111" y1="86.2969" y2="94.2969"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="111" x2="111" y1="94.2969" y2="135.1016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="111" x2="111" y1="135.1016" y2="193.3672"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="111" x2="111" y1="193.3672" y2="234.1719"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="111" x2="111" y1="234.1719" y2="331.5703"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="190.5" x2="190.5" y1="86.2969" y2="94.2969"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="190.5" x2="190.5" y1="94.2969" y2="135.1016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="190.5" x2="190.5" y1="135.1016" y2="193.3672"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="190.5" x2="190.5" y1="193.3672" y2="234.1719"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="190.5" x2="190.5" y1="234.1719" y2="331.5703"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="276.5" x2="276.5" y1="86.2969" y2="94.2969"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="276.5" x2="276.5" y1="94.2969" y2="135.1016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="276.5" x2="276.5" y1="135.1016" y2="193.3672"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="276.5" x2="276.5" y1="193.3672" y2="234.1719"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="276.5" x2="276.5" y1="234.1719" y2="331.5703"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="369" x2="369" y1="86.2969" y2="94.2969"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="369" x2="369" y1="94.2969" y2="135.1016"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="369" x2="369" y1="135.1016" y2="193.3672"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="369" x2="369" y1="193.3672" y2="234.1719"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="369" x2="369" y1="234.1719" y2="331.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="35" x="15" y="82.9951">Alice</text><ellipse cx="35.5" cy="13" fill="#FEFECE" filter="url(#foos23qajv8mr)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M35.5,21 L35.5,48 M22.5,29 L48.5,29 M35.5,48 L22.5,63 M35.5,48 L48.5,63 " fill="none" filter="url(#foos23qajv8mr)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="94" y="82.9951">Bob</text><ellipse cx="111" cy="13" fill="#FEFECE" filter="url(#foos23qajv8mr)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M111,21 L111,48 M98,29 L124,29 M111,48 L98,63 M111,48 L124,63 " fill="none" filter="url(#foos23qajv8mr)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="51" x="162" y="82.9951">Charlie</text><ellipse cx="190.5" cy="13" fill="#FEFECE" filter="url(#foos23qajv8mr)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M190.5,21 L190.5,48 M177.5,29 L203.5,29 M190.5,48 L177.5,63 M190.5,48 L203.5,63 " fill="none" filter="url(#foos23qajv8mr)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#foos23qajv8mr)" height="46.5938" style="stroke: #A80036; stroke-width: 1.5;" width="75" x="237" y="34.7031"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="49" x="250" y="54.6982">Sprites</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="244" y="70.9951">Contract</text><rect fill="#FEFECE" filter="url(#foos23qajv8mr)" height="62.8906" style="stroke: #A80036; stroke-width: 1.5;" width="82" x="326" y="18.4063"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="68" x="333" y="38.4014">Preimage</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="63" x="335.5" y="54.6982">Manager</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="61" x="336.5" y="70.9951">Contract</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="130" x="137.25" y="118.5073">parties send payments</text><polygon fill="#A80036" points="264.5,152.1016,274.5,156.1016,264.5,160.1016,268.5,156.1016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="111" x2="270.5" y1="156.1016" y2="156.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="43" x="118" y="151.1685">trigger</text><polygon fill="#A80036" points="357,181.2344,367,185.2344,357,189.2344,361,185.2344" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="111" x2="363" y1="185.2344" y2="185.2344"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="111" x="118" y="180.3013">submit preimage</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="136" x="134.25" y="217.5776">parties submit evidence</text><polygon fill="#A80036" points="264.5,251.1719,274.5,255.1719,264.5,259.1719,268.5,255.1719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="190.5" x2="270.5" y1="255.1719" y2="255.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="197.5" y="250.2388">finalize</text><polygon fill="#A80036" points="357,280.3047,367,284.3047,357,288.3047,361,284.3047" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="276.5" x2="363" y1="284.3047" y2="284.3047"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="283.5" y="279.3716">revealed ?</text><polygon fill="#A80036" points="46.5,309.4375,36.5,313.4375,46.5,317.4375,42.5,313.4375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="40.5" x2="275.5" y1="313.4375" y2="313.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="52.5" y="308.5044">disburse</text><polygon fill="#A80036" points="122,309.4375,112,313.4375,122,317.4375,118,313.4375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="116" x2="275.5" y1="313.4375" y2="313.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="128" y="308.5044">disburse</text><polygon fill="#A80036" points="201.5,309.4375,191.5,313.4375,201.5,317.4375,197.5,313.4375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="195.5" x2="275.5" y1="313.4375" y2="313.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="207.5" y="308.5044">disburse</text><!--
@startuml
!pragma teoz true

hide footbox

actor "   Alice   " as A
actor "    Bob    " as B
actor "  Charlie  " as C
participant Registry as "Sprites\nContract"
participant PM as "Preimage\nManager\nContract"
... parties send payments ...

B - -> Registry: trigger
B - -> PM: submit preimage
... parties submit evidence ...

C - -> Registry: finalize
Registry - -> PM: revealed ?
Registry - -> A: disburse
& Registry -> B: disburse
& Registry - -> C: disburse


@enduml

PlantUML version 1.2018.01(Mon Jan 29 02:08:22 HKT 2018)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_152-release-1036-b1
Operating System: Linux
OS Version: 4.14.32
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>